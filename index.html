<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Documentation for async-wait-until v2.0.7</title>
	<meta name="description" content="Documentation for Documentation for async-wait-until v2.0.7">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
	<script async src="assets/js/search.js" id="search-script"></script>
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.json" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">Documentation for async-wait-until v2.0.7</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<h1>Documentation for async-wait-until v2.0.7</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<a href="#async-wait-until" id="async-wait-until" style="color: inherit; text-decoration: none;">
					<h1>async-wait-until</h1>
				</a>
				<p>A tiny yet convenient and fast zero-dependency library that makes it possible to write an asynchronous code that awaits some event to happen. It works on any JavaScript runtime that supports <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise">Promises</a> either natively or with a polyfill (i.e. <a href="https://www.npmjs.com/package/promise-polyfill">this one</a>), including old Node.js versions and old web browsers.</p>
				<p><img src="https://img.shields.io/npm/v/async-wait-until" alt="npm version">
					<a href="https://npmjs.org/package/async-wait-until"><img src="https://img.shields.io/npm/dw/async-wait-until" alt="npm downloads, weekly"></a>
					<a href="https://devlato.github.io/async-wait-until/"><img src="https://img.shields.io/badge/%F0%9F%93%96-Documentation-informational" alt="online documentation"></a>
					<img src="https://github.com/devlato/async-wait-until/workflows/CI/badge.svg" alt="build status">
					<img src="https://img.shields.io/codeclimate/maintainability/devlato/async-wait-until" alt="maintainability">
					<img src="https://img.shields.io/codeclimate/coverage/devlato/async-wait-until" alt="code coverage">
					<img src="https://img.shields.io/bundlephobia/minzip/async-wait-until" alt="minzipped bundle size">
				<img src="https://img.shields.io/npm/l/async-wait-until" alt="license"></p>
				<a href="#⚙️-installation" id="⚙️-installation" style="color: inherit; text-decoration: none;">
					<h2>⚙️ Installation</h2>
				</a>
				<p>The package is available on <a href="https://npmjs.org/package/async-wait-until">npm</a>:</p>
				<pre><code class="language-sh"><span style="color: #24292E">$ npm install --save async-wait-until</span>
</code></pre>
				<p>It ships with a <a href="https://github.com/umdjs/umd">UMD</a> bundle by default (which works well as-is on Node.js and web browsers), but bundles for other module systems are also available in the package&#39;s <code>dist/</code> folder.</p>
				<pre><code class="language-ts"><span style="color: #D73A49">import</span><span style="color: #24292E"> { waitUntil } </span><span style="color: #D73A49">from</span><span style="color: #24292E"> </span><span style="color: #032F62">&#039;async-wait-until&#039;</span><span style="color: #24292E">;</span>

<span style="color: #6A737D">// ...</span>
<span style="color: #D73A49">await</span><span style="color: #24292E"> </span><span style="color: #6F42C1">waitUntil</span><span style="color: #24292E">(() </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> document.</span><span style="color: #6F42C1">querySelector</span><span style="color: #24292E">(</span><span style="color: #032F62">&#039;#hey&#039;</span><span style="color: #24292E">) </span><span style="color: #D73A49">!=</span><span style="color: #24292E"> </span><span style="color: #005CC5">null</span><span style="color: #24292E">);</span>
</code></pre>
				<details>
					<summary>Click to see examples for other module systems</summary>
					<ul>
						<li><a href="http://wiki.commonjs.org/wiki/Modules/1.1">CommonJS</a>:<pre><code class="language-js"><span style="color: #D73A49">const</span><span style="color: #24292E"> { </span><span style="color: #005CC5">waitUntil</span><span style="color: #24292E"> } </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">require</span><span style="color: #24292E">(</span><span style="color: #032F62">&#039;async-wait-until/dist/commonjs&#039;</span><span style="color: #24292E">);</span>
<span style="color: #6A737D">// ...</span>
</code></pre>
						</li>
						<li><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules#introducing_an_example">ES Modules</a>:<pre><code class="language-js"><span style="color: #D73A49">import</span><span style="color: #24292E"> { waitUntil } </span><span style="color: #D73A49">from</span><span style="color: #24292E"> </span><span style="color: #032F62">&#039;async-wait-until&#039;</span><span style="color: #24292E">;</span>
<span style="color: #6A737D">// ...</span>
</code></pre>
							or<pre><code class="language-js"><span style="color: #D73A49">import</span><span style="color: #24292E"> { waitUntil } </span><span style="color: #D73A49">from</span><span style="color: #24292E"> </span><span style="color: #032F62">&#039;async-wait-until/dist/index.esm.js&#039;</span><span style="color: #24292E">;</span>
<span style="color: #6A737D">// ...</span>
</code></pre>
						</li>
						<li><a href="https://github.com/amdjs/amdjs-api/wiki/AMD">AMD</a>:<pre><code class="language-html"><span style="color: #24292E">&lt;</span><span style="color: #22863A">script</span><span style="color: #24292E"> </span><span style="color: #6F42C1">type</span><span style="color: #24292E">=</span><span style="color: #032F62">&quot;text/javascript&quot;</span><span style="color: #24292E"> </span><span style="color: #6F42C1">src</span><span style="color: #24292E">=</span><span style="color: #032F62">&quot;scripts/require.js&quot;</span><span style="color: #24292E">&gt;&lt;/</span><span style="color: #22863A">script</span><span style="color: #24292E">&gt;</span>
<span style="color: #24292E">&lt;</span><span style="color: #22863A">script</span><span style="color: #24292E"> </span><span style="color: #6F42C1">type</span><span style="color: #24292E">=</span><span style="color: #032F62">&quot;text/javascript&quot;</span><span style="color: #24292E">&gt;</span>
<span style="color: #24292E">  requirejs.</span><span style="color: #6F42C1">config</span><span style="color: #24292E">({</span>
<span style="color: #24292E">    baseUrl: </span><span style="color: #032F62">&#039;scripts/node_modules&#039;</span><span style="color: #24292E">,</span>
<span style="color: #24292E">    paths: {</span>
<span style="color: #24292E">      </span><span style="color: #032F62">&#039;async-wait-until&#039;</span><span style="color: #24292E">: </span><span style="color: #032F62">&#039;async-wait-until/dist/amd.js&#039;</span><span style="color: #24292E">,</span>
<span style="color: #24292E">    },</span>
<span style="color: #24292E">  });</span>
<span style="color: #24292E">  </span><span style="color: #6F42C1">define</span><span style="color: #24292E">([</span><span style="color: #032F62">&#039;async-wait-until&#039;</span><span style="color: #24292E">], ({ </span><span style="color: #E36209">waitUntil</span><span style="color: #24292E"> }) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> {</span>
<span style="color: #24292E">    </span><span style="color: #6A737D">// ...</span>
<span style="color: #24292E">  });</span>
<span style="color: #24292E">&lt;/</span><span style="color: #22863A">script</span><span style="color: #24292E">&gt;</span>
</code></pre>
						</li>
						<li><a href="https://developer.mozilla.org/en-US/docs/Glossary/IIFE">IIFE</a>:<pre><code class="language-html"><span style="color: #24292E">&lt;</span><span style="color: #22863A">script</span><span style="color: #24292E"> </span><span style="color: #6F42C1">type</span><span style="color: #24292E">=</span><span style="color: #032F62">&quot;text/javascript&quot;</span><span style="color: #24292E"> </span><span style="color: #6F42C1">src</span><span style="color: #24292E">=</span><span style="color: #032F62">&quot;async-wait-until/dist/iife.js&quot;</span><span style="color: #24292E">&gt;&lt;/</span><span style="color: #22863A">script</span><span style="color: #24292E">&gt;</span>
<span style="color: #24292E">&lt;</span><span style="color: #22863A">script</span><span style="color: #24292E"> </span><span style="color: #6F42C1">type</span><span style="color: #24292E">=</span><span style="color: #032F62">&quot;text/javascript&quot;</span><span style="color: #24292E">&gt;</span>
<span style="color: #24292E">  </span><span style="color: #D73A49">const</span><span style="color: #24292E"> { </span><span style="color: #005CC5">waitUntil</span><span style="color: #24292E"> } </span><span style="color: #D73A49">=</span><span style="color: #24292E"> asyncWaitUntil;</span>
<span style="color: #24292E">  </span><span style="color: #6A737D">// ...    </span>
<span style="color: #24292E">&lt;/</span><span style="color: #22863A">script</span><span style="color: #24292E">&gt;</span>
</code></pre>
						</li>
						<li><a href="https://github.com/systemjs/systemjs">SystemJS</a>:<pre><code class="language-html"><span style="color: #24292E">&lt;</span><span style="color: #22863A">script</span><span style="color: #24292E"> </span><span style="color: #6F42C1">src</span><span style="color: #24292E">=</span><span style="color: #032F62">&quot;scripts/system.js&quot;</span><span style="color: #24292E">&gt;&lt;/</span><span style="color: #22863A">script</span><span style="color: #24292E">&gt;</span>
<span style="color: #24292E">&lt;</span><span style="color: #22863A">script</span><span style="color: #24292E"> </span><span style="color: #6F42C1">type</span><span style="color: #24292E">=</span><span style="color: #032F62">&quot;systemjs-importmap&quot;</span><span style="color: #24292E">&gt;</span>
<span style="color: #24292E">  {</span>
<span style="color: #24292E">    imports: {</span>
<span style="color: #24292E">      &#039;async-wait-until&#039;: &#039;./scripts/node_modules/async-wait-until/dist/systemjs.js&#039;,</span>
<span style="color: #24292E">    }</span>
<span style="color: #24292E">  }</span>
<span style="color: #24292E">&lt;/</span><span style="color: #22863A">script</span><span style="color: #24292E">&gt;</span>
<span style="color: #24292E">&lt;</span><span style="color: #22863A">script</span><span style="color: #24292E"> </span><span style="color: #6F42C1">type</span><span style="color: #24292E">=</span><span style="color: #032F62">&quot;systemjs-module&quot;</span><span style="color: #24292E">&gt;</span>
<span style="color: #24292E">  System</span>
<span style="color: #24292E">      .import(&#039;async-wait-until&#039;)</span>
<span style="color: #24292E">      .then(({ waitUntil }) =&gt; {</span>
<span style="color: #24292E">        // ...</span>
<span style="color: #24292E">      });</span>
<span style="color: #24292E">&lt;/</span><span style="color: #22863A">script</span><span style="color: #24292E">&gt;</span>
</code></pre>
				</details>
				</li>
				</ul>
				<a href="#👨💻👩💻-use" id="👨💻👩💻-use" style="color: inherit; text-decoration: none;">
					<h2>👨‍💻👩‍💻 Use</h2>
				</a>
				<p>Let&#39;s assume we have a piece of code that asynchronously appends a new <code>&lt;div /&gt;</code> node to the page body, and we want to wait for it to happen and then do something with that node.
				Let&#39;s also assume that for some unknown reason, we can neither use <a href="https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver">MutationObserver</a> nor modify the code that adds the node 🤷‍♂️. How bizarre!</p>
				<p>However, we know that optimistically, on a fast enough computer, this will happen within let&#39;s say 10 seconds (but it&#39;s not guaranteed). The following code snippet mimics this behaviour:</p>
				<pre><code class="language-js"><span style="color: #6A737D">// @file a-sneaky-module.js</span>

<span style="color: #6A737D">// Aha! Sometimes, it can take more than 10 seconds, and this is how we emulate it</span>
<span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #005CC5">MAX_IDLE_INTERVAL_MILLISECONDS_BEFORE_ADDING_A_DIV_IN</span><span style="color: #24292E"> </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">11</span><span style="color: #24292E"> </span><span style="color: #D73A49">*</span><span style="color: #24292E"> </span><span style="color: #005CC5">1000</span><span style="color: #24292E">;</span>

<span style="color: #6A737D">// Some utility functions, it&#039;s safe to ignore them </span>
<span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #6F42C1">randomIntegerInRange</span><span style="color: #24292E"> </span><span style="color: #D73A49">=</span><span style="color: #24292E"> ({ </span><span style="color: #E36209">min</span><span style="color: #24292E"> </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #005CC5">0</span><span style="color: #24292E">, </span><span style="color: #E36209">max</span><span style="color: #24292E"> }) </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> </span>
<span style="color: #24292E">  min </span><span style="color: #D73A49">+</span><span style="color: #24292E"> </span><span style="color: #005CC5">Math</span><span style="color: #24292E">.</span><span style="color: #005CC5">floor</span><span style="color: #24292E">(</span><span style="color: #005CC5">Math</span><span style="color: #24292E">.</span><span style="color: #005CC5">random</span><span style="color: #24292E">() </span><span style="color: #D73A49">*</span><span style="color: #24292E"> (max </span><span style="color: #D73A49">-</span><span style="color: #24292E"> min));</span>
<span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #6F42C1">randomTimeInterval</span><span style="color: #24292E"> </span><span style="color: #D73A49">=</span><span style="color: #24292E"> () </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> </span><span style="color: #6F42C1">randomIntegerInRange</span><span style="color: #24292E">({ </span>
<span style="color: #24292E">  max: </span><span style="color: #005CC5">MAX_IDLE_INTERVAL_MILLISECONDS_BEFORE_ADDING_A_DIV_IN</span><span style="color: #24292E">,</span>
<span style="color: #24292E">});</span>

<span style="color: #6A737D">// Adds a &lt;div /&gt; to the document body</span>
<span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #6F42C1">appendADivToTheDocumentBody</span><span style="color: #24292E"> </span><span style="color: #D73A49">=</span><span style="color: #24292E"> () </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> {</span>
<span style="color: #24292E">  </span><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #005CC5">node</span><span style="color: #24292E"> </span><span style="color: #D73A49">=</span><span style="color: #24292E"> document.</span><span style="color: #6F42C1">createElement</span><span style="color: #24292E">(</span><span style="color: #032F62">&#039;div&#039;</span><span style="color: #24292E">);</span>
<span style="color: #24292E">  node.className </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">&#039;spooky-spooky-skeleton&#039;</span><span style="color: #24292E">;</span>
<span style="color: #24292E">  window.document.body.</span><span style="color: #6F42C1">appendChild</span><span style="color: #24292E">(node);</span>
<span style="color: #24292E">};</span>

<span style="color: #6A737D">// A sneaky function that schedules adding a &lt;div /&gt; to the document body </span>
<span style="color: #6A737D">// at some time within 11 seconds</span>
<span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #6F42C1">appendADivToTheDocumentBodySomeAtTimeWithinAGivenTimeInterval</span><span style="color: #24292E"> </span><span style="color: #D73A49">=</span><span style="color: #24292E"> () </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> </span>
<span style="color: #24292E">  </span><span style="color: #005CC5">setTimeout</span><span style="color: #24292E">(</span>
<span style="color: #24292E">    appendADivToTheDocumentBody,</span>
<span style="color: #24292E">    </span><span style="color: #6F42C1">randomTimeInterval</span><span style="color: #24292E">(),</span>
<span style="color: #24292E">  );</span>

<span style="color: #D73A49">export</span><span style="color: #24292E"> </span><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #005CC5">doTheDivThing</span><span style="color: #24292E"> </span><span style="color: #D73A49">=</span><span style="color: #24292E"> appendADivToTheDocumentBodySomeAtTimeWithinAGivenTimeInterval;</span>
</code></pre>
				<p>Let&#39;s call the above code <code>a-sneaky-module.js</code>.</p>
				<p>So how do we the consumers of the <code>a-sneaky-module.js</code> know when exactly the <code>&lt;div /&gt;</code> node gets added?</p>
				<pre><code class="language-js"><span style="color: #D73A49">import</span><span style="color: #24292E"> { doTheDivThing } </span><span style="color: #D73A49">from</span><span style="color: #24292E"> </span><span style="color: #032F62">&#039;./a-sneaky-module.js&#039;</span><span style="color: #24292E">;</span>

<span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #6F42C1">doOutThing</span><span style="color: #24292E"> </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">async</span><span style="color: #24292E"> () </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> {</span>
<span style="color: #24292E">  </span><span style="color: #6A737D">// ...</span>

<span style="color: #24292E">  </span><span style="color: #6F42C1">doTheDivThing</span><span style="color: #24292E">();</span>
<span style="color: #24292E">  </span><span style="color: #6A737D">// Hmmmm... so what? How do we work with that &lt;div /&gt;. Is it already in the DOM?</span>
<span style="color: #24292E">};</span>
</code></pre>
				<p><code>async-wait-until</code> to the rescue, we can easily detect when it happens (and react to it):</p>
				<pre><code class="language-js"><span style="color: #D73A49">import</span><span style="color: #24292E"> { doTheDivThing } </span><span style="color: #D73A49">from</span><span style="color: #24292E"> </span><span style="color: #032F62">&#039;./a-sneaky-module.js&#039;</span><span style="color: #24292E">;</span>
<span style="color: #D73A49">import</span><span style="color: #24292E"> { waitUntil } </span><span style="color: #D73A49">from</span><span style="color: #24292E"> </span><span style="color: #032F62">&#039;./async-wait-until&#039;</span><span style="color: #24292E">;</span>

<span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #6F42C1">doOutThing</span><span style="color: #24292E"> </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">async</span><span style="color: #24292E"> () </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> {</span>
<span style="color: #24292E">  </span><span style="color: #6A737D">// ...</span>
<span style="color: #24292E">  </span>
<span style="color: #24292E">  </span><span style="color: #6F42C1">doTheDivThing</span><span style="color: #24292E">();</span>

<span style="color: #24292E">  </span><span style="color: #6A737D">// Yup! Easy right?</span>
<span style="color: #24292E">  </span><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #005CC5">divNode</span><span style="color: #24292E"> </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">await</span><span style="color: #24292E"> </span><span style="color: #6F42C1">waitUntil</span><span style="color: #24292E">(</span>
<span style="color: #24292E">    </span><span style="color: #6A737D">// Here, we specify a function that will be repeatedly called from time to time</span>
<span style="color: #24292E">    </span><span style="color: #6A737D">// Let&#039;s call this kind of functions a `predicate`</span>
<span style="color: #24292E">    () </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> window.document.body.</span><span style="color: #6F42C1">querySelector</span><span style="color: #24292E">(</span><span style="color: #032F62">&#039;div.spooky-spooky-skeleton&#039;</span><span style="color: #24292E">),</span>
<span style="color: #24292E">    </span><span style="color: #6A737D">// Here, we can specify a timeout in milliseconds. Once it passes, </span>
<span style="color: #24292E">    </span><span style="color: #6A737D">// we&#039;ll stop waiting and throw an exception</span>
<span style="color: #24292E">    { timeout: </span><span style="color: #005CC5">10000</span><span style="color: #24292E"> },</span>
<span style="color: #24292E">  );</span>
<span style="color: #24292E">  </span><span style="color: #6A737D">// A colour of triumph</span>
<span style="color: #24292E">  divNode.style.backgroundColor </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">&#039;rgba(255, 0, 0, 0.5)&#039;</span><span style="color: #24292E">;</span>
<span style="color: #24292E">};</span>
</code></pre>
				<p>However, we aren&#39;t 100% sure that the <code>&lt;div /&gt;</code> will be added within 10 seconds. What will happen if 10 seconds have passed and the <code>&lt;div /&gt;</code> node still isn&#39;t there?</p>
				<p>From the above code, it&#39;s clear that our <code>&#39;predicate&#39;</code> function (or simply <code>&#39;preddcate&#39;</code>) won&#39;t return the DOM node. So what <code>waitUntil</code> will do in that case is it will throw a <code>TimeoutException</code> (also exported from the library so you can handle it).</p>
				<pre><code class="language-js"><span style="color: #D73A49">import</span><span style="color: #24292E"> { doTheDivThing } </span><span style="color: #D73A49">from</span><span style="color: #24292E"> </span><span style="color: #032F62">&#039;./a-sneaky-module.js&#039;</span><span style="color: #24292E">;</span>
<span style="color: #D73A49">import</span><span style="color: #24292E"> { waitUntil, TimeoutError } </span><span style="color: #D73A49">from</span><span style="color: #24292E"> </span><span style="color: #032F62">&#039;./async-wait-until&#039;</span><span style="color: #24292E">;</span>

<span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #6F42C1">doOurThing</span><span style="color: #24292E"> </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">async</span><span style="color: #24292E"> () </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> {</span>
<span style="color: #24292E">  </span><span style="color: #6A737D">// ...</span>
<span style="color: #24292E">  </span>
<span style="color: #24292E">  </span><span style="color: #6F42C1">doTheDivThing</span><span style="color: #24292E">();</span>

<span style="color: #24292E">  </span><span style="color: #D73A49">try</span><span style="color: #24292E"> {</span>
<span style="color: #24292E">    </span><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #6F42C1">predicate</span><span style="color: #24292E"> </span><span style="color: #D73A49">=</span><span style="color: #24292E"> () </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> window.document.body.</span><span style="color: #6F42C1">querySelector</span><span style="color: #24292E">(</span><span style="color: #032F62">&#039;div.spooky-spooky-skeleton&#039;</span><span style="color: #24292E">);</span>
<span style="color: #24292E">    </span><span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #005CC5">divNode</span><span style="color: #24292E"> </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #D73A49">await</span><span style="color: #24292E"> </span><span style="color: #6F42C1">waitUntil</span><span style="color: #24292E">(predicate, { timeout: </span><span style="color: #005CC5">10000</span><span style="color: #24292E"> });</span>
<span style="color: #24292E">    </span>
<span style="color: #24292E">    divNode.style.backgroundColor </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #032F62">&#039;rgba(255, 0, 0, 0.5)&#039;</span><span style="color: #24292E">;</span>
<span style="color: #24292E">  } </span><span style="color: #D73A49">catch</span><span style="color: #24292E"> (e) {</span>
<span style="color: #24292E">    </span><span style="color: #D73A49">if</span><span style="color: #24292E"> (e </span><span style="color: #D73A49">instanceof</span><span style="color: #24292E"> </span><span style="color: #6F42C1">TimeoutError</span><span style="color: #24292E">) {</span>
<span style="color: #24292E">      </span><span style="color: #6A737D">// Unfortunately, 10 seconds have passed but we haven&#039;t detected the `&lt;div /&gt;`</span>
<span style="color: #24292E">      </span><span style="color: #6A737D">// If we had a UI, we could show an error there or allow user to retry</span>
<span style="color: #24292E">      </span><span style="color: #6F42C1">alert</span><span style="color: #24292E">(</span><span style="color: #032F62">&#039;No &lt;div /&gt; have been detected unfortunately&#039;</span><span style="color: #24292E">);</span>
<span style="color: #24292E">    } </span><span style="color: #D73A49">else</span><span style="color: #24292E"> {</span>
<span style="color: #24292E">      </span><span style="color: #6A737D">// Some another error, most likely thrown from the predicate function.</span>
<span style="color: #24292E">      </span><span style="color: #6F42C1">alert</span><span style="color: #24292E">(</span><span style="color: #032F62">&#039;Unknown error occurred&#039;</span><span style="color: #24292E">);</span>
<span style="color: #24292E">      console.</span><span style="color: #6F42C1">error</span><span style="color: #24292E">(e);</span>
<span style="color: #24292E">    }    </span>
<span style="color: #24292E">  }</span>
<span style="color: #24292E">};</span>
</code></pre>
				<p>So, summing up the above, the predicate will run again and again within the given timeout, until it first returns a non-<a href="https://developer.mozilla.org/en-US/docs/Glossary/Falsy">falsy</a> value. If this doesn&#39;t happen, a <code>TimeoutError</code> is thrown.</p>
				<a href="#api" id="api" style="color: inherit; text-decoration: none;">
					<h3>API</h3>
				</a>
				<p>Lets&#39; start with the <code>waitUntil</code> function. It takes up to two parameters (<strong>deprecated</strong>: up to three), and returns a Promise that will be resolved with the first non-falsy value returned by the predicate.</p>
				<table>
					<thead>
						<tr>
							<th>Parameter</th>
							<th>Type</th>
							<th>Required</th>
							<th>Default</th>
							<th>Description</th>
						</tr>
					</thead>
					<tbody><tr>
							<td><code>predicate</code></td>
							<td>Function</td>
							<td>✅ Yes</td>
							<td>-</td>
							<td>A function that is expected to return a non-falsy (aka a <code>&#39;truthy&#39;</code>) value, or a Promise to return such a value. Hence, <em>both sync and async functions are supported</em>.</td>
						</tr>
						<tr>
							<td><code>options</code></td>
							<td>Options object</td>
							<td>🚫 No</td>
							<td>500 ms</td>
							<td>Options for the wait algorithm implemented by <code>waitUntil</code>, see its properties on the below table. <strong>Deprecated</strong>: timeout in milliseconds.</td>
						</tr>
						<tr>
							<td><del>intervalBetweenAttempts</del></td>
							<td>number</td>
							<td>🚫 No</td>
							<td>50 ms</td>
							<td><strong>Deprecated parameter</strong>: number of milliseconds between retry attempts. Please use options instead.</td>
						</tr>
				</tbody></table>
				<p>Above, you could see the options param. Here are the available <strong>options</strong>:</p>
				<table>
					<thead>
						<tr>
							<th>Parameter</th>
							<th>Type</th>
							<th>Required</th>
							<th>Default</th>
							<th>Description</th>
						</tr>
					</thead>
					<tbody><tr>
							<td><code>timeout</code></td>
							<td>number</td>
							<td>🚫 No</td>
							<td>500 ms</td>
							<td>Timeout in milliseconds.</td>
						</tr>
						<tr>
							<td><code>intervalBetweenAttempts</code></td>
							<td>number</td>
							<td>🚫 No</td>
							<td>50 ms</td>
							<td>Number of milliseconds between retry attempts.</td>
						</tr>
				</tbody></table>
				<a href="#recipes" id="recipes" style="color: inherit; text-decoration: none;">
					<h3>Recipes</h3>
				</a>
				<a href="#waiting-for-something-forever" id="waiting-for-something-forever" style="color: inherit; text-decoration: none;">
					<h4>Waiting for something forever</h4>
				</a>
				<p>If you aren&#39;t sure how long with a process take, you can use <code>waitUntil.Forever</code> (which is a shortcut for <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/POSITIVE_INFINITY">Number.POSITIVE_INFINITY</a>) as the timeout value:</p>
				<pre><code class="language-ts"><span style="color: #D73A49">import</span><span style="color: #24292E"> { waitUntil, WAIT_FOREVER } </span><span style="color: #D73A49">from</span><span style="color: #24292E"> </span><span style="color: #032F62">&#039;async-wait-until&#039;</span><span style="color: #24292E">;</span>

<span style="color: #6A737D">// ...</span>

<span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #005CC5">result</span><span style="color: #24292E"> </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">waitUntil</span><span style="color: #24292E">(() </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> </span><span style="color: #005CC5">Date</span><span style="color: #24292E">.</span><span style="color: #6F42C1">now</span><span style="color: #24292E">() </span><span style="color: #D73A49">&gt;=</span><span style="color: #24292E"> </span><span style="color: #D73A49">new</span><span style="color: #24292E"> </span><span style="color: #005CC5">Date</span><span style="color: #24292E">(</span><span style="color: #032F62">&#039;Jan 13, 2022 11:35 am&#039;</span><span style="color: #24292E">), {</span>
<span style="color: #24292E">  timeout: </span><span style="color: #005CC5">WAIT_FOREVER</span><span style="color: #24292E">, </span><span style="color: #6A737D">// === Number.POSITIVE_INFINITY</span>
<span style="color: #24292E">});</span>
</code></pre>
				<a href="#customizing-the-interval-between-retries" id="customizing-the-interval-between-retries" style="color: inherit; text-decoration: none;">
					<h4>Customizing the interval between retries</h4>
				</a>
				<p>In addition to the <code>timeout</code> option, you can customize the interval between retries:</p>
				<pre><code class="language-ts"><span style="color: #D73A49">import</span><span style="color: #24292E"> { waitUntil } </span><span style="color: #D73A49">from</span><span style="color: #24292E"> </span><span style="color: #032F62">&#039;async-wait-until&#039;</span><span style="color: #24292E">;</span>

<span style="color: #6A737D">// ...</span>

<span style="color: #D73A49">const</span><span style="color: #24292E"> </span><span style="color: #005CC5">result</span><span style="color: #24292E"> </span><span style="color: #D73A49">=</span><span style="color: #24292E"> </span><span style="color: #6F42C1">waitUntil</span><span style="color: #24292E">(() </span><span style="color: #D73A49">=&gt;</span><span style="color: #24292E"> </span><span style="color: #005CC5">Date</span><span style="color: #24292E">.</span><span style="color: #6F42C1">now</span><span style="color: #24292E">() </span><span style="color: #D73A49">&gt;=</span><span style="color: #24292E"> </span><span style="color: #D73A49">new</span><span style="color: #24292E"> </span><span style="color: #005CC5">Date</span><span style="color: #24292E">(</span><span style="color: #032F62">&#039;Jan 13, 2022 11:35 am&#039;</span><span style="color: #24292E">), {</span>
<span style="color: #24292E">  intervalBetweenAttempts: </span><span style="color: #005CC5">1000</span><span style="color: #24292E">, </span><span style="color: #6A737D">// Retry every second instead of 50 milliseconds</span>
<span style="color: #24292E">});</span>
</code></pre>
				<a href="#👨⚖️👩⚖️-license" id="👨⚖️👩⚖️-license" style="color: inherit; text-decoration: none;">
					<h2>👨‍⚖️👩‍⚖️ License</h2>
				</a>
				<p>Library is shipped &quot;as is&quot; under the MIT License.</p>
				<a href="#👷♂️👷♀️-contributing" id="👷♂️👷♀️-contributing" style="color: inherit; text-decoration: none;">
					<h2>👷‍♂️👷‍♀️ Contributing</h2>
				</a>
				<p>Contributions (issues, bug and feature requests, and PRs) are welcome! Please follow the contribution guidelines.</p>
				<details>
					<summary>Click for additional information on development dependencies and available commands</summary>
					<a href="#development-dependencies" id="development-dependencies" style="color: inherit; text-decoration: none;">
						<h3>Development dependencies</h3>
					</a>
					<ol>
						<li>The library is written in <a href="http://typescriptlang.org">TypeScript</a> and is bundled with <a href="https://parceljs.org">Parcel</a>.</li>
						<li>Code style is powered by <a href="https://eslint.org">ESLint</a> and <a href="https://prettier.io">Prettier</a> with a custom config.</li>
						<li>We use <a href="http://jestjs.io/">jest</a> for running unit tests.</li>
					</ol>
					<a href="#available-commands" id="available-commands" style="color: inherit; text-decoration: none;">
						<h3>Available commands</h3>
					</a>
					<a href="#test" id="test" style="color: inherit; text-decoration: none;">
						<h4>Test:</h4>
					</a>
					<pre><code class="language-sh"><span style="color: #24292E">$ npm </span><span style="color: #005CC5">test</span>
</code></pre>
					<a href="#lint" id="lint" style="color: inherit; text-decoration: none;">
						<h4>Lint:</h4>
					</a>
					<pre><code class="language-sh"><span style="color: #24292E">$ npm run lint</span>
</code></pre>
					<a href="#reformat" id="reformat" style="color: inherit; text-decoration: none;">
						<h4>Reformat:</h4>
					</a>
					<pre><code class="language-sh"><span style="color: #24292E">$ npm run format</span>
</code></pre>
					<a href="#build" id="build" style="color: inherit; text-decoration: none;">
						<h4>Build</h4>
					</a>
					<pre><code class="language-sh"><span style="color: #24292E">$ npm run build</span>
</code></pre>
					<a href="#generate-docs" id="generate-docs" style="color: inherit; text-decoration: none;">
						<h4>Generate docs</h4>
					</a>
					<pre><code class="language-sh"><span style="color: #24292E">$ npm run docs</span>
</code></pre>
				</details>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class=" ">
						<a href="modules.html">Exports</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
					<li class=" tsd-kind-reference">
						<a href="modules.html#default" class="tsd-kind-icon">default</a>
					</li>
					<li class=" tsd-kind-class">
						<a href="classes/timeouterror.html" class="tsd-kind-icon">Timeout<wbr>Error</a>
					</li>
					<li class=" tsd-kind-type-alias tsd-is-private">
						<a href="modules.html#falsyvalue" class="tsd-kind-icon">Falsy<wbr>Value</a>
					</li>
					<li class=" tsd-kind-type-alias">
						<a href="modules.html#options" class="tsd-kind-icon">Options</a>
					</li>
					<li class=" tsd-kind-type-alias tsd-has-type-parameter tsd-is-private">
						<a href="modules.html#predicate" class="tsd-kind-icon">Predicate</a>
					</li>
					<li class=" tsd-kind-type-alias tsd-is-private">
						<a href="modules.html#predicatereturnvalue" class="tsd-kind-icon">Predicate<wbr>Return<wbr>Value</a>
					</li>
					<li class=" tsd-kind-type-alias tsd-is-private">
						<a href="modules.html#truthyvalue" class="tsd-kind-icon">Truthy<wbr>Value</a>
					</li>
					<li class=" tsd-kind-variable">
						<a href="modules.html#default_interval_between_attempts_in_ms" class="tsd-kind-icon">DEFAULT_<wbr>INTERVAL_<wbr>BETWEEN_<wbr>ATTEMPTS_<wbr>IN_<wbr>MS</a>
					</li>
					<li class=" tsd-kind-variable">
						<a href="modules.html#default_timeout_in_ms" class="tsd-kind-icon">DEFAULT_<wbr>TIMEOUT_<wbr>IN_<wbr>MS</a>
					</li>
					<li class=" tsd-kind-variable">
						<a href="modules.html#wait_forever" class="tsd-kind-icon">WAIT_<wbr>FOREVER</a>
					</li>
					<li class=" tsd-kind-function tsd-has-type-parameter">
						<a href="modules.html#waituntil" class="tsd-kind-icon">wait<wbr>Until</a>
					</li>
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
</body>
</html>